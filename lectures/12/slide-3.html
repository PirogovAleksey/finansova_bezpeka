<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>12.3 Аналіз інцидентів | Фінансова Безпека</title>
  <link rel="icon" type="image/svg+xml" href="../../img/favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/slides.css">
</head>
<body>
  <div class="top-controls">
    <a href="../../lecture.html?id=12"><svg viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg>До лекції</a>
    <button onclick="toggleTheme()"><span id="theme-icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg></span><span id="theme-label">Світла</span></button>
  </div>
  <div class="slide-deck">
    <section class="slide active">
      <span class="slide-icon">🔬</span>
      <h1>Аналіз інцидентів</h1>
      <p class="subtitle">Лекція 12.3</p>
      <span class="tag tag-blue" style="margin-top: 1rem;">Malware analysis, memory forensics, log analysis</span>
    </section>
    <section class="slide">
      <h1>Malware Analysis</h1>
      <div class="steps">
        <div class="step"><div class="step-num">1</div><div class="step-title">Статичний аналіз (Static)</div><div class="step-desc">Strings, PE headers, imports, VirusTotal hash lookup</div></div>
        <div class="step"><div class="step-num">2</div><div class="step-title">Динамічний аналіз (Dynamic)</div><div class="step-desc">Sandbox (ANY.RUN): файли, реєстр, мережа, C2</div></div>
        <div class="step"><div class="step-num">3</div><div class="step-title">Зворотна розробка (Reverse)</div><div class="step-desc">IDA Pro, Ghidra: дизасемблювання, логіка malware</div></div>
        <div class="step"><div class="step-num">4</div><div class="step-title">IOC Extract</div><div class="step-desc">C2 domains, IP, hashes, YARA rules для detection</div></div>
      </div>
    </section>
    <section class="slide">
      <h1>Network Forensics</h1>
      <div class="card-grid">
        <div class="card accent-blue"><span class="card-icon">📡</span><div class="card-title">Аналіз PCAP (PCAP Analysis)</div><div class="card-text">Wireshark, NetworkMiner: аналіз мережевого трафіку</div></div>
        <div class="card accent-red"><span class="card-icon">🔗</span><div class="card-title">Виявлення C2 (C2 Detection)</div><div class="card-text">Beacon patterns, DNS tunneling, encrypted channels</div></div>
        <div class="card accent-orange"><span class="card-icon">📤</span><div class="card-title">Ексфільтрація (Exfiltration)</div><div class="card-text">Незвичний обсяг вихідних даних, нетипові протоколи</div></div>
        <div class="card accent-green"><span class="card-icon">🕐</span><div class="card-title">Хронологія (Timeline)</div><div class="card-text">Хронологія подій з NetFlow, firewall, proxy логів</div></div>
      </div>
    </section>
    <section class="slide">
      <h1>Log Analysis</h1>
      <div class="icon-list">
        <div class="icon-list-item"><span class="il-icon">🖥️</span><span class="il-text"><strong>Windows Events</strong> — 4624 (logon), 4625 (failed), 4688 (process), 7045 (service)</span></div>
        <div class="icon-list-item"><span class="il-icon">🐧</span><span class="il-text"><strong>Syslog</strong> — auth.log, secure, application logs на Linux системах</span></div>
        <div class="icon-list-item"><span class="il-icon">📊</span><span class="il-text"><strong>SIEM</strong> — Splunk, Elastic, Sentinel: кореляція з усіх джерел</span></div>
        <div class="icon-list-item"><span class="il-icon">📋</span><span class="il-text"><strong>Sigma Rules</strong> — стандартний формат detection rules для будь-якого SIEM</span></div>
      </div>
    </section>
    <section class="slide">
      <h1>MITRE ATT&CK</h1>
      <h2>Класифікація тактик та технік атакуючого</h2>
      <div class="two-col">
        <div class="col">
          <div class="card accent-red" style="height: 100%;">
            <span class="card-icon">⚔️</span>
            <div class="card-title">Тактики (ЩО)</div>
            <div class="card-text" style="margin-top: 8px; font-size: 0.95rem; line-height: 1.7;">Initial Access<br>Execution<br>Persistence<br>Privilege Escalation<br>Lateral Movement<br>Exfiltration</div>
          </div>
        </div>
        <div class="col">
          <div class="card accent-blue" style="height: 100%;">
            <span class="card-icon">🔧</span>
            <div class="card-title">Техніки (ЯК)</div>
            <div class="card-text" style="margin-top: 8px; font-size: 0.95rem; line-height: 1.7;">Phishing (T1566)<br>PowerShell (T1059.001)<br>Registry Run Keys (T1547)<br>Pass-the-Hash (T1550)<br>SMB/RDP (T1021)<br>HTTP C2 (T1071)</div>
          </div>
        </div>
      </div>
    </section>
    <section class="slide">
      <h1>Приклад Sigma Rule</h1>
      <h2>Стандартний формат detection rule для будь-якого SIEM</h2>
      <div class="code-block" style="background: var(--card-bg); border-radius: 12px; padding: 1.2rem; font-family: monospace; font-size: 0.85rem; line-height: 1.6; overflow-x: auto; border: 1px solid var(--border);">
        <span style="color: var(--accent-blue);">title:</span> Suspicious PowerShell Encoded Command<br>
        <span style="color: var(--accent-blue);">status:</span> experimental<br>
        <span style="color: var(--accent-blue);">logsource:</span><br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">product:</span> windows<br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">category:</span> process_creation<br>
        <span style="color: var(--accent-blue);">detection:</span><br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">selection:</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;CommandLine|contains: '-enc'<br>
        &nbsp;&nbsp;&nbsp;&nbsp;Image|endswith: 'powershell.exe'<br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">condition:</span> selection<br>
        <span style="color: var(--accent-blue);">level:</span> high
      </div>
      <div class="highlight-box" style="margin-top: 1.2rem;">
        <p>Sigma конвертується в Splunk SPL, Elastic KQL, Microsoft Sentinel та інші SIEM через sigmac/pySigma.</p>
      </div>
    </section>
    <section class="slide">
      <h1>Структура YARA Rule</h1>
      <h2>Пошук malware за сигнатурами у файлах та пам'яті</h2>
      <div class="code-block" style="background: var(--card-bg); border-radius: 12px; padding: 1.2rem; font-family: monospace; font-size: 0.85rem; line-height: 1.6; overflow-x: auto; border: 1px solid var(--border);">
        <span style="color: var(--accent-blue);">rule</span> Detect_Cobalt_Strike {<br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">meta:</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;author = "SOC Team"<br>
        &nbsp;&nbsp;&nbsp;&nbsp;description = "Cobalt Strike beacon"<br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">strings:</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;$s1 = "%d is an x86 dll" ascii<br>
        &nbsp;&nbsp;&nbsp;&nbsp;$s2 = "beacon.dll" ascii<br>
        &nbsp;&nbsp;&nbsp;&nbsp;$s3 = { 4D 5A 90 00 03 00 }<br>
        &nbsp;&nbsp;<span style="color: var(--accent-orange);">condition:</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;uint16(0) == 0x5A4D and 2 of ($s*)<br>
        }
      </div>
      <div class="highlight-box" style="margin-top: 1.2rem;">
        <p>YARA працює з файлами, RAM дампами, мережевим трафіком. Інтегрується з VirusTotal, THOR, Loki Scanner.</p>
      </div>
    </section>
    <section class="slide">
      <h1>Memory Forensics з Volatility</h1>
      <h2>Аналіз дампу оперативної пам'яті</h2>
      <div class="steps">
        <div class="step"><div class="step-num">1</div><div class="step-title">imageinfo</div><div class="step-desc">Визначення профілю ОС: версія Windows/Linux, архітектура, KDBG offset</div></div>
        <div class="step"><div class="step-num">2</div><div class="step-title">pslist / pstree</div><div class="step-desc">Список процесів, parent-child зв'язки, виявлення підозрілих та прихованих процесів</div></div>
        <div class="step"><div class="step-num">3</div><div class="step-title">netscan</div><div class="step-desc">Мережеві з'єднання з RAM: C2 адреси, порти, стан сокетів навіть для завершених сесій</div></div>
        <div class="step"><div class="step-num">4</div><div class="step-title">malfind / yarascan</div><div class="step-desc">Пошук injected code, RWX секцій, YARA сканування пам'яті процесів</div></div>
      </div>
      <div class="highlight-box" style="margin-top: 1.2rem;">
        <p>Volatility 3: Python-based, модульний, підтримує Windows, Linux, macOS. Ключовий інструмент для fileless malware.</p>
      </div>
    </section>
    <section class="slide">
      <h1>Network Forensics: Wireshark</h1>
      <h2>Глибокий аналіз мережевого трафіку</h2>
      <div class="icon-list">
        <div class="icon-list-item"><span class="il-icon">🔎</span><span class="il-text"><strong>Display Filters</strong> — ip.addr == 10.0.0.1 && tcp.port == 443 для фільтрації підозрілого трафіку</span></div>
        <div class="icon-list-item"><span class="il-icon">📡</span><span class="il-text"><strong>Follow Stream</strong> — реконструкція TCP/HTTP сесій, перегляд переданих даних та C2 команд</span></div>
        <div class="icon-list-item"><span class="il-icon">📊</span><span class="il-text"><strong>Statistics</strong> — Conversations, Protocol Hierarchy: виявлення аномальних обсягів та протоколів</span></div>
        <div class="icon-list-item"><span class="il-icon">📦</span><span class="il-text"><strong>Export Objects</strong> — витягування файлів з HTTP/SMB трафіку: malware samples, exfiltrated documents</span></div>
      </div>
      <div class="highlight-box" style="margin-top: 1.2rem;">
        <p>Для beacon detection: Statistics → Conversations → Sort by Packets. C2 beacons мають регулярні інтервали.</p>
      </div>
    </section>
    <section class="slide">
      <span class="slide-icon">🛡️</span>
      <h1>Ключові висновки</h1>
      <div class="icon-list">
        <div class="icon-list-item"><span class="il-icon">1️⃣</span><span class="il-text"><strong>Malware analysis</strong> — static → dynamic → reverse → IOC extraction</span></div>
        <div class="icon-list-item"><span class="il-icon">2️⃣</span><span class="il-text"><strong>Network forensics</strong> — PCAP, C2 detection, exfiltration analysis</span></div>
        <div class="icon-list-item"><span class="il-icon">3️⃣</span><span class="il-text"><strong>SIEM + Sigma</strong> — централізований log analysis зі стандартними rules</span></div>
        <div class="icon-list-item"><span class="il-icon">4️⃣</span><span class="il-text"><strong>MITRE ATT&CK</strong> — спільна мова для опису тактик та технік атакуючого</span></div>
      </div>
    </section>
  </div>
  <div class="slide-counter" id="counter"></div>
  <div class="slide-progress" id="progress"></div>
  <div class="controls"><button onclick="prev()">&#8592;</button><button onclick="next()">&#8594;</button></div>
  <script src="../../js/slides.js"></script>
</body>
</html>
