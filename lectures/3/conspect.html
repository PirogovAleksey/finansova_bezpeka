<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Конспект лекції 3: Автентифікація та контроль доступу у фінансових системах.">
  <meta name="author" content="Кафедра ТЕІБ, Ужгородський національний університет">
  <meta name="theme-color" content="#0ea5e9">
  <title>Конспект: Лекція 3 — Фінансова Безпека</title>
  <link rel="icon" type="image/svg+xml" href="../../img/favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/style.css">
  <script>if(localStorage.getItem('theme')==='dark')document.documentElement.classList.add('dark')</script>
</head>
<body>

  <aside>
    <div class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          <path d="M9 12l2 2 4-4"/>
        </svg>
      </div>
      <div class="logo-text">
        Фінансова<br>Безпека
        <span>онлайн-курс</span>
      </div>
    </div>

    <nav aria-label="Головна навігація">
      <a href="../../index.html" class="active">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg></span>
        Лекції
      </a>
      <a href="../../practicals.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg></span>
        Практичні
      </a>
      <a href="../../tests.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg></span>
        Тести
      </a>
      <a href="../../materials.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg></span>
        Матеріали
      </a>
    </nav>

    <div class="sidebar-footer">
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="Перемкнути тему">
        <svg id="theme-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
        <span id="theme-label">Темна тема</span>
      </button>
    </div>
  </aside>

  <main>
    <div class="lecture-nav-top">
      <a href="../../lecture.html?id=3" class="back-link">&larr; Назад до лекції 3</a>
      <span class="lecture-badge">Конспект лекції 3</span>
    </div>

    <article class="lecture-content">
      <h1>Автентифікація та контроль доступу</h1>
      <div class="lecture-info">
        <span>⏱ 2 год</span>
        <span class="badge badge-new">Конспект</span>
      </div>

      <!-- Section 3.1 -->
      <section>
        <h2>3.1 Механізми автентифікації у фінансовому секторі</h2>

        <p>Автентифікація — це процес підтвердження ідентичності користувача або системи. У фінансовому секторі автентифікація є першою лінією оборони: саме вона стоїть між зловмисником та доступом до рахунків, транзакцій і конфіденційних даних клієнтів. За даними Verizon Data Breach Investigations Report 2024, понад 80% зламів, пов'язаних з веб-додатками, використовують скомпрометовані або слабкі облікові дані.</p>

        <p><strong>Три фактори автентифікації:</strong></p>
        <ul>
          <li><strong>Щось, що ви знаєте (Knowledge)</strong> — пароль, PIN-код, секретне питання. Це найпоширеніший, але найслабший фактор: паролі можна вгадати, перехопити, вкрасти через фішинг або отримати з витоків даних.</li>
          <li><strong>Щось, що ви маєте (Possession)</strong> — апаратний токен, смартфон із TOTP-додатком, смарт-картка, USB-ключ FIDO2. Фізичне володіння пристроєм значно ускладнює атаку.</li>
          <li><strong>Щось, що ви є (Inherence)</strong> — біометричні дані: відбиток пальця, розпізнавання обличчя (Face ID), сканування сітківки, голосова верифікація.</li>
        </ul>

        <p><strong>Проблеми паролів у фінансовому секторі.</strong> Незважаючи на десятиліття рекомендацій щодо складності паролів, вони залишаються найслабшою ланкою. Дослідження NordPass показує, що «123456» залишається найпопулярнішим паролем у світі. У фінансовому секторі це особливо небезпечно: credential stuffing атаки використовують бази витоків (понад 15 мільярдів скомпрометованих облікових записів в інтернеті) для автоматичного підбору паролів до банківських акаунтів. Рекомендації NIST SP 800-63B відмовились від примусової зміни паролів кожні 90 днів та вимог до спеціальних символів, натомість рекомендуючи довгі парольні фрази та перевірку паролів на наявність у базах витоків.</p>

        <p><strong>Multi-Factor Authentication (MFA)</strong> — це вимога двох або більше факторів для підтвердження ідентичності. Основні методи MFA у фінансових системах:</p>
        <ul>
          <li><strong>TOTP (Time-based One-Time Password)</strong> — генерація одноразових кодів, що змінюються кожні 30 секунд (Google Authenticator, Authy). Базується на спільному секреті та поточному часі. Переваги: працює офлайн, не залежить від мобільної мережі. Недоліки: вразливий до фішингу в реальному часі (зловмисник може перехопити код і використати його).</li>
          <li><strong>FIDO2/WebAuthn</strong> — стандарт безпарольної автентифікації з використанням криптографії з публічним ключем. Приватний ключ зберігається на пристрої (YubiKey, Touch ID, Windows Hello) і ніколи не передається серверу. Ключова перевага: повна стійкість до фішингу — автентифікація прив'язана до конкретного домену (origin binding), тому підроблений сайт не зможе перехопити credentials.</li>
          <li><strong>Push-нотифікації</strong> — додаток на смартфоні показує деталі операції і просить підтвердити або відхилити. Використовується у багатьох банківських додатках (Приват24, monobank). Ризик: MFA fatigue attacks — зловмисник надсилає десятки push-запитів, доки користувач випадково не натисне «Підтвердити» (атака на Uber у 2022 році).</li>
          <li><strong>SMS OTP</strong> — одноразовий код через SMS. Найпоширеніший, але найменш безпечний метод MFA: вразливий до SIM-swapping (зловмисник переносить номер жертви на свою SIM-картку), SS7-атак та перехоплення SMS. NIST визнає SMS OTP небажаним методом (restricted authenticator).</li>
        </ul>

        <p><strong>Біометрична автентифікація у банкінгу.</strong> Біометрія активно впроваджується у фінансовому секторі. ПриватБанк використовує Face ID для підтвердження транзакцій, monobank — відбиток пальця. Mastercard тестує оплату з розпізнаванням обличчя на касах. Важливі аспекти: біометричні дані не можна замінити (на відміну від пароля, відбиток пальця не змінити після витоку), тому вони повинні зберігатися лише локально на пристрої або у зашифрованому вигляді. Liveness detection запобігає атакам з фотографіями та масками.</p>

        <p><strong>Passwordless-автентифікація</strong> — майбутнє фінансової автентифікації. Стандарт Passkeys (FIDO Alliance + Apple/Google/Microsoft) дозволяє входити в акаунт без пароля, використовуючи біометрію пристрою або PIN. Ключі синхронізуються між пристроями через хмару (iCloud Keychain, Google Password Manager). Банки поступово впроваджують passkeys: у 2024 році кілька великих фінансових установ (Paypal, Kayak) запустили підтримку passkeys для входу.</p>
      </section>

      <!-- Section 3.2 -->
      <section>
        <h2>3.2 Токени, сесії та протоколи автентифікації</h2>

        <p>Після успішної автентифікації система повинна «запам'ятати» користувача та надавати доступ без повторного введення credentials при кожному запиті. Для цього використовуються токени та сесії — механізми, що підтверджують ідентичність протягом певного часу.</p>

        <p><strong>JWT (JSON Web Token)</strong> — найпоширеніший формат токенів у сучасних веб-додатках та API. JWT складається з трьох частин, розділених крапкою:</p>
        <ol>
          <li><strong>Header</strong> — метадані токена: алгоритм підпису (HS256, RS256) та тип токена.</li>
          <li><strong>Payload</strong> — корисне навантаження: ідентифікатор користувача (sub), час видачі (iat), час закінчення (exp), ролі, дозволи та інші claims.</li>
          <li><strong>Signature</strong> — цифровий підпис, що гарантує цілісність токена. Для HMAC використовується спільний секрет, для RSA — приватний ключ сервера.</li>
        </ol>

        <p><strong>Вразливості JWT, критичні для фінансових систем:</strong></p>
        <ul>
          <li><strong>Algorithm None Attack</strong> — зловмисник змінює алгоритм у header на «none», і сервер приймає токен без перевірки підпису. Контрзахід: завжди перевіряти алгоритм на стороні сервера, використовувати whitelist дозволених алгоритмів.</li>
          <li><strong>Algorithm Confusion (RS256 → HS256)</strong> — якщо сервер підтримує обидва алгоритми, зловмисник може підписати токен публічним ключем RSA як HMAC-секретом. Контрзахід: фіксувати алгоритм для кожного ключа.</li>
          <li><strong>Відсутність перевірки exp</strong> — токен без терміну дії або з ігноруванням exp на сервері дає безстрокові права доступу.</li>
          <li><strong>Зберігання секретів у payload</strong> — payload лише закодований у Base64, а не зашифрований. Будь-хто може прочитати вміст.</li>
          <li><strong>Відсутність механізму відкликання (revocation)</strong> — JWT є stateless, тому скомпрометований токен неможливо анулювати до закінчення терміну дії. Рішення: короткий час життя access token (5-15 хвилин), blacklist відкликаних токенів, використання refresh token rotation.</li>
        </ul>

        <p><strong>OAuth 2.0</strong> — фреймворк делегованої авторизації, що дозволяє третім сторонам отримувати обмежений доступ до ресурсів без передачі пароля. У FinTech-контексті OAuth 2.0 критично важливий для Open Banking: клієнт може надати фінтех-додатку доступ до свого банківського акаунту без розкриття пароля банку.</p>
        <ul>
          <li><strong>Authorization Code Flow з PKCE</strong> — найбезпечніший flow, рекомендований для мобільних та SPA-додатків. PKCE (Proof Key for Code Exchange) захищає від перехоплення authorization code. Процес: клієнт генерує code_verifier → обчислює code_challenge → надсилає challenge на authorization server → обмінює code + verifier на токен.</li>
          <li><strong>Client Credentials Flow</strong> — для server-to-server взаємодії (наприклад, мікросервіс платежів звертається до сервісу верифікації). Клієнт автентифікується своїми credentials (client_id + client_secret) напряму.</li>
          <li><strong>Device Authorization Grant</strong> — для пристроїв без браузера (IoT-термінали, банкомати). Пристрій показує код, користувач вводить його на окремому пристрої.</li>
        </ul>

        <p><strong>OpenID Connect (OIDC)</strong> — надбудова над OAuth 2.0, що додає стандартизовану автентифікацію. OAuth 2.0 відповідає на питання «що дозволено?» (авторизація), а OIDC — «хто це?» (автентифікація). OIDC повертає ID Token (JWT з інформацією про користувача) разом з access token. UserInfo endpoint надає додаткові дані профілю. У фінансовому секторі OIDC використовується для Single Sign-On між сервісами одного банку та для Open Banking інтеграцій.</p>

        <p><strong>Session Management у фінансових системах</strong> вимагає підвищеної безпеки:</p>
        <ul>
          <li><strong>Короткий час сесії</strong> — для інтернет-банкінгу типовий таймаут 5-15 хвилин неактивності. Для високо-ризикових операцій — повторна автентифікація (step-up authentication).</li>
          <li><strong>Session fixation protection</strong> — генерація нового session ID після автентифікації для запобігання підміни сесії.</li>
          <li><strong>Secure cookie attributes</strong> — HttpOnly (захист від XSS), Secure (тільки HTTPS), SameSite=Strict (захист від CSRF), короткий Max-Age.</li>
          <li><strong>Concurrent session control</strong> — обмеження кількості одночасних сесій. Якщо оператор банку вже увійшов з одного робочого місця, вхід з іншого повинен або блокуватися, або завершити попередню сесію.</li>
          <li><strong>Binding до контексту</strong> — прив'язка сесії до IP-адреси, User-Agent, fingerprint пристрою. Зміна цих параметрів вимагає повторної автентифікації.</li>
        </ul>
      </section>

      <!-- Section 3.3 -->
      <section>
        <h2>3.3 Моделі авторизації: RBAC, ABAC, ReBAC</h2>

        <p>Якщо автентифікація відповідає на питання «хто ви?», то авторизація визначає «що вам дозволено робити?». У фінансовому секторі правильна модель авторизації запобігає ситуаціям, коли касир може схвалювати кредити, а стажер — переглядати конфіденційні дані VIP-клієнтів.</p>

        <p><strong>RBAC (Role-Based Access Control)</strong> — найпоширеніша модель авторизації. Доступ надається не окремим користувачам, а ролям, які потім призначаються користувачам.</p>
        <ul>
          <li><strong>Принцип роботи:</strong> визначаються ролі (касир, менеджер, аудитор, адміністратор), кожній ролі призначається набір дозволів (permissions), користувачу призначається одна або кілька ролей.</li>
          <li><strong>Приклад у банку:</strong> роль «Касир» має дозволи: view_account, create_transaction (до 50 000 грн); роль «Менеджер» додає: approve_transaction, view_reports; роль «Аудитор» має: view_all_transactions, generate_reports, але не може створювати транзакції.</li>
          <li><strong>Ієрархічний RBAC</strong> — ролі можуть успадковувати дозволи: «Старший касир» включає всі дозволи «Касир» плюс додаткові.</li>
          <li><strong>Обмеження RBAC:</strong> role explosion — у великих організаціях кількість ролей зростає експоненціально, коли потрібно враховувати комбінації відділів, регіонів, типів клієнтів. Банк з 10 відділеннями, 5 департаментами та 4 рівнями доступу потенційно потребує 200 ролей.</li>
        </ul>

        <p><strong>ABAC (Attribute-Based Access Control)</strong> — більш гнучка модель, де рішення про доступ приймається на основі атрибутів суб'єкта, об'єкта, дії та контексту.</p>
        <ul>
          <li><strong>Атрибути суб'єкта:</strong> відділ, посада, рівень допуску, сертифікації.</li>
          <li><strong>Атрибути об'єкта:</strong> тип даних, рівень конфіденційності, власник.</li>
          <li><strong>Атрибути середовища:</strong> час доби, IP-адреса, геолокація, рівень ризику.</li>
          <li><strong>Приклад політики:</strong> «Менеджер з департаменту кредитування може схвалювати кредити до 1 000 000 грн у робочий час (09:00-18:00) з корпоративної мережі для клієнтів свого відділення».</li>
          <li><strong>Переваги:</strong> одна політика замінює десятки ролей RBAC; динамічне прийняття рішень на основі контексту; легше реалізувати принцип найменших привілеїв.</li>
        </ul>

        <p><strong>ReBAC (Relationship-Based Access Control)</strong> — модель, де доступ визначається відносинами між сутностями. Натхнення: Google Zanzibar — система авторизації, що обслуговує мільярди перевірок для Google Drive, YouTube, Cloud.</p>
        <ul>
          <li><strong>Принцип:</strong> замість «User має Role» — «User має Relationship з Object». Наприклад: «Іванов є менеджером клієнта Петренко» → Іванов може переглядати рахунки Петренко.</li>
          <li><strong>Застосування у FinTech:</strong> банківський менеджер бачить дані лише своїх клієнтів; сімейні акаунти — батько має доступ до акаунту дитини; корпоративний банкінг — CFO має доступ до всіх рахунків компанії, а бухгалтер — лише до операційного.</li>
          <li><strong>Інструменти:</strong> OpenFGA (open-source реалізація Zanzibar), SpiceDB, Ory Keto.</li>
        </ul>

        <p><strong>Policy-as-Code та Open Policy Agent (OPA).</strong> Сучасний підхід — описувати політики авторизації як код, що зберігається у Git, проходить code review та автоматично розгортається. OPA (Open Policy Agent) — найпопулярніший engine для Policy-as-Code. Політики пишуться мовою Rego:</p>
        <ul>
          <li>Єдина точка прийняття рішень для мікросервісів, API, Kubernetes, Terraform.</li>
          <li>Версіонування політик через Git — аудит змін, rollback, approval process.</li>
          <li>Тестування політик як звичайного коду — unit-тести для правил авторизації.</li>
          <li>Decoupling — зміна політик без перерозгортання сервісів.</li>
        </ul>
      </section>

      <!-- Section 3.4 -->
      <section>
        <h2>3.4 IAM та управління привілейованим доступом</h2>

        <p>Identity and Access Management (IAM) — це комплексна система управління ідентичностями, автентифікацією та авторизацією в організації. У фінансовому секторі IAM є критичною інфраструктурою: він визначає, хто має доступ до чого, від моменту прийому на роботу до звільнення.</p>

        <p><strong>Identity Lifecycle Management</strong> — управління повним циклом життя ідентичності:</p>
        <ol>
          <li><strong>Joiner (приєднання)</strong> — новий співробітник отримує акаунти, ролі та доступ відповідно до посади. Автоматичний provisioning через інтеграцію IAM з HR-системою: дані з SAP HR → автоматичне створення акаунтів у Active Directory, банківських системах, email.</li>
          <li><strong>Mover (переміщення)</strong> — при зміні посади або відділу доступи повинні бути переглянуті. Попередні дозволи відкликаються, нові надаються. Типова проблема: privilege creep — накопичення зайвих дозволів при переміщеннях без належного відкликання старих.</li>
          <li><strong>Leaver (звільнення)</strong> — негайне блокування всіх акаунтів. У фінансовому секторі це критично: звільнений працівник з активними credentials — це інсайдерська загроза. SLA на деактивацію має бути мінімальним (хвилини, не дні).</li>
        </ol>

        <p><strong>Single Sign-On (SSO) та Federation.</strong> SSO дозволяє користувачу автентифікуватися один раз і отримати доступ до всіх пов'язаних систем без повторного входу. Federation розширює SSO за межі організації:</p>
        <ul>
          <li><strong>SAML 2.0</strong> — XML-based протокол для SSO між організаціями. Широко використовується у корпоративному середовищі та B2B-інтеграціях фінансового сектору.</li>
          <li><strong>OIDC Federation</strong> — сучасна альтернатива SAML, базована на OAuth 2.0/OIDC. Простіша реалізація, кращий досвід для мобільних додатків.</li>
          <li><strong>SCIM (System for Cross-domain Identity Management)</strong> — протокол автоматичної синхронізації ідентичностей між системами. Коли HR створює або деактивує запис — SCIM автоматично синхронізує зміни з усіма підключеними системами.</li>
        </ul>

        <p><strong>PAM (Privileged Access Management)</strong> — управління привілейованими акаунтами (root, admin, DBA, системні акаунти), які мають розширений доступ до критичних систем. Компрометація привілейованого акаунту — це найкоротший шлях до катастрофи: за даними Forrester, 80% порушень безпеки пов'язані з привілейованим доступом.</p>
        <ul>
          <li><strong>Password Vault</strong> — централізоване зберігання паролів привілейованих акаунтів у зашифрованому сховищі. Адміністратори не знають паролів — вони «витягуються» з vault автоматично для кожної сесії. CyberArk, HashiCorp Vault, Delinea — лідери ринку PAM.</li>
          <li><strong>Session Recording</strong> — запис усіх дій привілейованих користувачів. Кожна команда адміністратора в production-середовищі логується для аудиту та розслідувань.</li>
          <li><strong>Just-in-Time (JIT) Access</strong> — привілейований доступ надається лише на час виконання конкретного завдання, після чого автоматично відкликається. Замість постійного root-доступу — запит на 2 години для оновлення системи.</li>
          <li><strong>Secrets Management</strong> — HashiCorp Vault зберігає API-ключі, credentials баз даних, сертифікати. Автоматична ротація секретів: пароль до бази даних змінюється кожні 24 години без втручання людини.</li>
        </ul>

        <p><strong>Розділення обов'язків (Separation of Duties — SoD)</strong> — принцип, що вимагає участі кількох осіб для завершення критичної операції, запобігаючи шахрайству та помилкам:</p>
        <ul>
          <li><strong>Статичне SoD</strong> — одна людина не може мати конфліктуючі ролі. Наприклад: особа, яка створює платіжне доручення, не може його схвалювати; розробник не має прямого доступу до production.</li>
          <li><strong>Динамічне SoD</strong> — обмеження на рівні транзакцій: один оператор може створити переказ, але для переказу понад 100 000 грн потрібно підтвердження другого оператора (dual control).</li>
          <li><strong>Кейс:</strong> у системі SWIFT обов'язковим є принцип 4-eyes — кожен переказ повинен бути ініційований одним оператором та схвалений іншим. Після атаки на Bangladesh Bank (2016) SWIFT посилив вимоги до SoD та впровадив обов'язковий dual authorization для переказів понад визначений ліміт.</li>
        </ul>

        <p><strong>Periodic Access Review (рекапітуляція доступу)</strong> — регулярний (щоквартальний або щорічний) перегляд усіх наданих доступів. Менеджери та власники систем підтверджують або відкликають доступ для кожного користувача. Це вимога регуляторів (PCI DSS Requirement 7, SOX, НБУ) та ефективний спосіб виявлення orphaned accounts та надлишкових привілеїв.</p>
      </section>

      <!-- Summary -->
      <section>
        <h2>Підсумок</h2>
        <p>У цій лекції ми розглянули повний ландшафт автентифікації та контролю доступу у фінансових системах. Сучасна автентифікація еволюціонує від паролів до passwordless-рішень на основі FIDO2 та passkeys, MFA стає обов'язковим стандартом, а біометрія доповнює традиційні фактори. JWT-токени та OAuth 2.0/OIDC забезпечують безпечну авторизацію для API та мікросервісів, але вимагають правильної імплементації для уникнення критичних вразливостей.</p>
        <p>Моделі авторизації — від класичного RBAC до гнучкого ABAC та ReBAC — дозволяють реалізувати принцип найменших привілеїв на рівні, що відповідає складності фінансових організацій. IAM та PAM забезпечують управління повним циклом ідентичностей та захист привілейованого доступу, а принцип розділення обов'язків (SoD) запобігає шахрайству.</p>
        <p><strong>У наступній лекції</strong> ми розглянемо клієнтські атаки: XSS (міжсайтовий скриптинг), CSRF та інші вразливості клієнтської частини веб-додатків у контексті фінансових систем.</p>
      </section>
    </article>

    <div class="lecture-nav-bottom">
      <a href="../../lecture.html?id=3" class="nav-btn">&larr; Назад до лекції</a>
      <span></span>
    </div>

    <footer></footer>
  </main>

  <script src="../../js/main.js"></script>

</body>
</html>
