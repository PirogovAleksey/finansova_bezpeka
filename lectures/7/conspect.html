<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Конспект лекції 7: Безпека платіжних систем — PCI DSS, карткові транзакції, мобільні платежі.">
  <meta name="author" content="Кафедра ТЕІБ, Ужгородський національний університет">
  <meta name="theme-color" content="#0ea5e9">
  <title>Конспект: Лекція 7 — Фінансова Безпека</title>
  <link rel="icon" type="image/svg+xml" href="../../img/favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/style.css">
  <script>if(localStorage.getItem('theme')==='dark')document.documentElement.classList.add('dark')</script>
</head>
<body>

  <aside>
    <div class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          <path d="M9 12l2 2 4-4"/>
        </svg>
      </div>
      <div class="logo-text">
        Фінансова<br>Безпека
        <span>онлайн-курс</span>
      </div>
    </div>

    <nav aria-label="Головна навігація">
      <a href="../../index.html" class="active">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg></span>
        Лекції
      </a>
      <a href="../../practicals.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg></span>
        Практичні
      </a>
      <a href="../../tests.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg></span>
        Тести
      </a>
      <a href="../../materials.html">
        <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg></span>
        Матеріали
      </a>
    </nav>

    <div class="sidebar-footer">
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="Перемкнути тему">
        <svg id="theme-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
        <span id="theme-label">Темна тема</span>
      </button>
    </div>
  </aside>

  <main>
    <div class="lecture-nav-top">
      <a href="../../lecture.html?id=7" class="back-link">&larr; Назад до лекції 7</a>
      <span class="lecture-badge">Конспект лекції 7</span>
    </div>

    <article class="lecture-content">
      <h1>Безпека платіжних систем</h1>
      <div class="lecture-info">
        <span>⏱ 2 год</span>
        <span class="badge badge-new">Конспект</span>
      </div>

      <!-- Section 7.1 -->
      <section>
        <h2>7.1 PCI DSS — стандарт безпеки платіжних карток</h2>

        <p>Payment Card Industry Data Security Standard (PCI DSS) — це стандарт безпеки, розроблений PCI Security Standards Council (заснований Visa, Mastercard, American Express, Discover, JCB). PCI DSS є обов'язковим для всіх організацій, що зберігають, обробляють або передають дані платіжних карток. Порушення стандарту загрожує штрафами до $100 000 на місяць та відкликанням права приймати карткові платежі.</p>

        <p><strong>12 вимог PCI DSS (v4.0):</strong></p>
        <ol>
          <li><strong>Встановити та підтримувати firewall</strong> — мережевий захист cardholder data environment (CDE).</li>
          <li><strong>Не використовувати default паролі</strong> — змінити всі vendor-supplied defaults для системних паролів та параметрів безпеки.</li>
          <li><strong>Захистити збережені дані карток</strong> — шифрування PAN, заборона зберігання CVV/CVC після авторизації, маскування PAN при відображенні.</li>
          <li><strong>Шифрувати передачу даних карток</strong> — TLS 1.2+ для будь-якої передачі PAN через публічні мережі.</li>
          <li><strong>Захист від malware</strong> — антивірусне ПЗ на всіх системах у CDE, регулярне оновлення.</li>
          <li><strong>Розробляти безпечні системи</strong> — Secure SDLC, патч-менеджмент, захист від відомих вразливостей.</li>
          <li><strong>Обмежити доступ до даних карток</strong> — need-to-know principle, RBAC, мінімальні привілеї.</li>
          <li><strong>Ідентифікувати та автентифікувати доступ</strong> — унікальний ID для кожного користувача, MFA для адміністративного доступу.</li>
          <li><strong>Обмежити фізичний доступ</strong> — контроль доступу до серверних, камери, журнали відвідувань.</li>
          <li><strong>Логувати та моніторити доступ</strong> — логування всіх дій з даними карток, централізований SIEM, збереження логів мінімум 1 рік.</li>
          <li><strong>Регулярно тестувати безпеку</strong> — щоквартальне ASV-сканування, щорічний пентест, wireless-сканування.</li>
          <li><strong>Підтримувати політику безпеки</strong> — документована політика ІБ, awareness-тренінги, incident response plan.</li>
        </ol>

        <p><strong>Рівні комплаєнсу PCI DSS</strong> залежать від обсягу транзакцій: Level 1 (>6 млн транзакцій/рік) — щорічний аудит QSA + щоквартальне ASV-сканування; Level 2 (1-6 млн) — SAQ + ASV; Level 3 (20K-1 млн e-commerce) — SAQ + ASV; Level 4 (<20K) — SAQ. Більшість українських банків підпадають під Level 1-2.</p>

        <p><strong>PCI DSS v4.0 (2024)</strong> — оновлення з фокусом на: customized approach (гнучкість у виконанні вимог), розширені вимоги до MFA, targeted risk analysis, enhanced security awareness, автоматизація тестування.</p>

        <p><strong>Таблиця 12 вимог PCI DSS із зіставленням цілей безпеки:</strong></p>
<pre><code>┌──────┬─────────────────────────────────────────┬──────────────────────────┐
│ Req# │ Вимога                                  │ Ціль безпеки             │
├──────┼─────────────────────────────────────────┼──────────────────────────┤
│  1   │ Встановити та підтримувати firewall      │ Захист мережі            │
│  2   │ Не використовувати default паролі        │ Захист мережі            │
│  3   │ Захистити збережені дані карток          │ Захист даних             │
│  4   │ Шифрувати передачу даних                 │ Захист даних             │
│  5   │ Захист від malware                       │ Управління вразливостями │
│  6   │ Розробляти безпечні системи              │ Управління вразливостями │
│  7   │ Обмежити доступ (need-to-know)           │ Контроль доступу         │
│  8   │ Ідентифікувати та автентифікувати        │ Контроль доступу         │
│  9   │ Обмежити фізичний доступ                 │ Контроль доступу         │
│ 10   │ Логувати та моніторити доступ            │ Моніторинг і тестування  │
│ 11   │ Регулярно тестувати безпеку              │ Моніторинг і тестування  │
│ 12   │ Підтримувати політику безпеки            │ Політика ІБ              │
└──────┴─────────────────────────────────────────┴──────────────────────────┘</code></pre>

        <p><strong>Рівні комплаєнсу та вимоги до валідації:</strong></p>
<pre><code>┌─────────┬────────────────────────┬────────────────────────────────────────┐
│ Рівень  │ Обсяг транзакцій/рік   │ Вимоги до валідації                    │
├─────────┼────────────────────────┼────────────────────────────────────────┤
│ Level 1 │ > 6 млн                │ Щорічний аудит QSA (on-site)           │
│         │                        │ + Щоквартальне ASV-сканування          │
│         │                        │ + Attestation of Compliance (AOC)      │
├─────────┼────────────────────────┼────────────────────────────────────────┤
│ Level 2 │ 1 — 6 млн              │ Щорічний SAQ (Self-Assessment)         │
│         │                        │ + Щоквартальне ASV-сканування          │
├─────────┼────────────────────────┼────────────────────────────────────────┤
│ Level 3 │ 20 000 — 1 млн         │ Щорічний SAQ                           │
│         │ (e-commerce)           │ + Щоквартальне ASV-сканування          │
├─────────┼────────────────────────┼────────────────────────────────────────┤
│ Level 4 │ &lt; 20 000               │ Щорічний SAQ                           │
│         │                        │ (ASV за рекомендацією acquirer)        │
└─────────┴────────────────────────┴────────────────────────────────────────┘</code></pre>

        <p><strong>Дерево вибору SAQ (Self-Assessment Questionnaire):</strong></p>
<pre><code>Чи зберігаєте/обробляєте/передаєте дані карток?
│
├── НІ → PCI DSS не застосовується
│
└── ТАК → Чи є card-not-present (e-commerce) канал?
    │
    ├── ТАК → Чи повністю outsource обробку платежів?
    │   │
    │   ├── ТАК → Чи є iframe/redirect (без PAN на вашому сервері)?
    │   │   │
    │   │   ├── ТАК → SAQ A  (найменший обсяг — 22 вимоги)
    │   │   └── НІ  → SAQ A-EP (частковий контроль платіжної сторінки)
    │   │
    │   └── НІ → Чи є власний payment application?
    │       │
    │       ├── ТАК → SAQ D (повний — 329 вимог)
    │       └── НІ  → SAQ C-VT (віртуальний термінал)
    │
    └── НІ → Card-present (POS)?
        │
        ├── P2PE-сертифікований термінал → SAQ P2PE (мінімальний)
        ├── Standalone terminal, no storage → SAQ B
        ├── IP-connected terminal → SAQ C
        └── Інше → SAQ D (повний)</code></pre>

        <p><strong>Фрагмент звіту ASV-сканування (Approved Scanning Vendor):</strong></p>
<pre><code># ASV Scan Report — Summary
# Scanner: Qualys PCI (ASV #4243-01-08)
# Scan Date: 2024-11-15  Target: payments.example.ua

SCAN STATUS: FAIL

┌────────────────────────┬──────────┬─────────────────────────────────────────┐
│ Host / IP              │ Severity │ Finding                                 │
├────────────────────────┼──────────┼─────────────────────────────────────────┤
│ 203.0.113.10 :443      │ HIGH     │ TLS 1.0 enabled — must disable          │
│                        │          │ (PCI DSS Req 4.1)                       │
├────────────────────────┼──────────┼─────────────────────────────────────────┤
│ 203.0.113.10 :443      │ MEDIUM   │ SSL certificate expires in 12 days      │
├────────────────────────┼──────────┼─────────────────────────────────────────┤
│ 203.0.113.11 :8080     │ HIGH     │ Apache Struts CVE-2024-XXXX —           │
│                        │          │ remote code execution (Req 6.2)         │
├────────────────────────┼──────────┼─────────────────────────────────────────┤
│ 203.0.113.12 :3306     │ CRITICAL │ MySQL port exposed to Internet           │
│                        │          │ (PCI DSS Req 1.3.7)                     │
└────────────────────────┴──────────┴─────────────────────────────────────────┘

REMEDIATION REQUIRED:
 1. Disable TLS 1.0/1.1 on payments.example.ua (Req 4.1)
 2. Renew SSL certificate before expiry
 3. Patch Apache Struts to latest version (Req 6.2)
 4. Block external access to MySQL port 3306 (Req 1.3.7)

Next quarterly scan deadline: 2025-02-15</code></pre>

        <div class="control-questions">
          <h3>Контрольні запитання</h3>
          <ol>
            <li>Які організації зобов'язані дотримуватися стандарту PCI DSS та які наслідки порушення вимог?</li>
            <li>У чому різниця між рівнями комплаєнсу PCI DSS (Level 1–4) та які вимоги до валідації існують для кожного рівня?</li>
            <li>Яка роль SAQ (Self-Assessment Questionnaire) у процесі PCI DSS комплаєнсу та як обирається тип SAQ?</li>
            <li>Що таке ASV-сканування та з якою періодичністю його необхідно проводити?</li>
            <li>Які ключові зміни було впроваджено у PCI DSS версії 4.0 порівняно з попередніми версіями?</li>
          </ol>
        </div>
      </section>

      <!-- Section 7.2 -->
      <section>
        <h2>7.2 Безпека карткових транзакцій</h2>

        <p>Карткові транзакції проходять складний ланцюжок обробки: від POS-термінала або веб-сайту через acquirer до card network (Visa/Mastercard) та issuer банку. Кожна ланка потребує захисту.</p>

        <p><strong>EMV (Europay, Mastercard, Visa)</strong> — стандарт смарт-карток з чіпом, що замінив магнітну стрічку:</p>
        <ul>
          <li>Чіп генерує унікальний криптограм для кожної транзакції (dynamic authentication), на відміну від статичних даних магнітної стрічки, які легко клонувати.</li>
          <li>EMV зменшив card-present fraud на 76% у країнах з повним впровадженням.</li>
          <li>Liability shift: відповідальність за fraud покладається на сторону, що не підтримує EMV (якщо термінал не підтримує чіп — відповідає торговець).</li>
        </ul>

        <p><strong>Токенізація платежів</strong> — заміна реального PAN (номера картки) на унікальний токен:</p>
        <ul>
          <li><strong>Network-level tokenization</strong> — Visa/Mastercard замінюють PAN на токен для конкретного торговця/каналу. Токен виглядає як номер картки, але непридатний для використання в іншому контексті.</li>
          <li><strong>Merchant-level tokenization</strong> — торговець зберігає токен замість PAN. Повторні платежі використовують токен, PAN ніколи не зберігається у merchant системах.</li>
          <li>Токенізація суттєво зменшує PCI DSS scope: системи, що працюють лише з токенами, не підпадають під повні вимоги PCI DSS.</li>
        </ul>

        <p><strong>3D Secure 2.0 (3DS2)</strong> — протокол автентифікації онлайн-платежів:</p>
        <ul>
          <li>При онлайн-покупці issuer банк може вимагати додаткову автентифікацію (push у банківський додаток, OTP, біометрію).</li>
          <li>3DS2 (порівняно з 3DS1) передає значно більше даних для risk-based аналізу: device fingerprint, billing address, transaction history — що дозволяє issuer автоматично схвалювати низько-ризикові транзакції (frictionless flow).</li>
          <li>PSD2 Strong Customer Authentication (SCA) у ЄС вимагає 3DS2 для більшості онлайн-платежів.</li>
          <li>Liability shift: при використанні 3DS відповідальність за fraud переходить від торговця до issuer банку.</li>
        </ul>

        <p><strong>Point-to-Point Encryption (P2PE)</strong> — шифрування даних картки від моменту зчитування на терміналі до processing host. Дані ніколи не з'являються у відкритому вигляді в мережі торговця, що значно зменшує PCI DSS scope та ризик компрометації через malware на POS-системах.</p>

        <p><strong>Схема потоку EMV-транзакції (chip-and-PIN):</strong></p>
<pre><code>EMV Transaction Flow (Contact Chip)
====================================

 Картка              POS-термінал           Acquirer          Card Network         Issuer
   │                      │                    │                  │                  │
   │  1. Insert card      │                    │                  │                  │
   │─────────────────────>│                    │                  │                  │
   │                      │                    │                  │                  │
   │  2. SELECT AID       │                    │                  │                  │
   │  (Application ID)    │                    │                  │                  │
   │<─────────────────────│                    │                  │                  │
   │  AID: A0000000031010 │ (Visa)             │                  │                  │
   │─────────────────────>│                    │                  │                  │
   │                      │                    │                  │                  │
   │  3. GET PROCESSING   │                    │                  │                  │
   │     OPTIONS (GPO)    │                    │                  │                  │
   │<─────────────────────│                    │                  │                  │
   │  AFL, AIP            │                    │                  │                  │
   │─────────────────────>│                    │                  │                  │
   │                      │                    │                  │                  │
   │  4. READ RECORDS     │                    │                  │                  │
   │  (PAN, expiry, etc.) │                    │                  │                  │
   │<─────────────────────│                    │                  │                  │
   │  Card data           │                    │                  │                  │
   │─────────────────────>│                    │                  │                  │
   │                      │                    │                  │                  │
   │  5. Cardholder       │                    │                  │                  │
   │     Verification     │                    │                  │                  │
   │     (PIN entry)      │                    │                  │                  │
   │<────── PIN OK ───────│                    │                  │                  │
   │                      │                    │                  │                  │
   │  6. GENERATE AC      │                    │                  │                  │
   │  (Application        │                    │                  │                  │
   │   Cryptogram)        │                    │                  │                  │
   │<─────────────────────│                    │                  │                  │
   │  ARQC (Authorization │                    │                  │                  │
   │  Request Cryptogram) │                    │                  │                  │
   │─────────────────────>│                    │                  │                  │
   │                      │  7. Authorization  │                  │                  │
   │                      │     Request        │                  │                  │
   │                      │  (PAN + ARQC +     │                  │                  │
   │                      │   amount + ...)    │                  │                  │
   │                      │───────────────────>│  8. Route to     │                  │
   │                      │                    │     issuer       │                  │
   │                      │                    │─────────────────>│  9. Verify ARQC  │
   │                      │                    │                  │  (shared key)    │
   │                      │                    │                  │  Check balance   │
   │                      │                    │                  │  Risk analysis   │
   │                      │                    │  10. Response    │                  │
   │                      │                    │<─────────────────│  ARPC + Auth Code│
   │                      │  11. Auth Response │                  │                  │
   │                      │<───────────────────│                  │                  │
   │  12. TC / AAC        │                    │                  │                  │
   │  (Transaction        │                    │                  │                  │
   │   Certificate or     │                    │                  │                  │
   │   decline)           │                    │                  │                  │
   │<─────────────────────│                    │                  │                  │
   │                      │                    │                  │                  │
   │  Remove card         │  Print receipt     │                  │                  │

Криптограм ARQC = MAC(shared_key, amount | currency | date | ATC | unpredictable_number)
 - Унікальний для кожної транзакції → клонування неможливе
 - ATC (Application Transaction Counter) — лічильник, що збільшується з кожною транзакцією</code></pre>

        <p><strong>Процес токенізації платежів:</strong></p>
<pre><code>Токенізація: заміна PAN на токен
=================================

Крок 1: Реєстрація картки (Enrollment)
─────────────────────────────────────────
Клієнт вводить:    PAN: 4149 6288 0123 4567
                   Exp: 12/26   CVV: 321

Token Service Provider (TSP) генерує:
   Token PAN:      4149 6200 0098 7654    ← виглядає як справжній PAN
   Token Requestor ID: merchant_abc_123
   Token Domain:   e-commerce
   Token Expiry:   12/26

Mapping (зберігається ТІЛЬКИ у TSP vault):
   Token  4149620000987654 ──→ PAN  4149628801234567
                                    (AES-256 encrypted)

Крок 2: Оплата з використанням токену
─────────────────────────────────────────
Торговець ──→ Acquirer ──→ Card Network (TSP)
  Token PAN: 4149 6200 0098 7654
  Cryptogram: 8A3F...B2C1
  Amount: 500.00 UAH

TSP виконує de-tokenization:
  Token → PAN (lookup у vault)
  Forwarding до Issuer: PAN 4149 6288 0123 4567 + cryptogram

Крок 3: Issuer обробляє транзакцію зі справжнім PAN
─────────────────────────────────────────
Response: Approved (Auth Code: 847291)

Переваги токенізації:
 - Торговець НІКОЛИ не бачить реальний PAN
 - Витік бази торговця → токени непридатні для fraud
 - Один PAN може мати різні токени для різних торговців
 - Клієнт може деактивувати токен без перевипуску картки</code></pre>

        <p><strong>Потік автентифікації 3D Secure 2.0:</strong></p>
<pre><code>3D Secure 2.0 — Authentication Flow
=====================================

Клієнт          Торговець         3DS Server        Directory        ACS (Issuer)
  │                │                  │              Server (DS)          │
  │  1. Checkout   │                  │                 │                 │
  │  (card data)   │                  │                 │                 │
  │───────────────>│                  │                 │                 │
  │                │  2. 3DS Auth     │                 │                 │
  │                │     Request      │                 │                 │
  │                │  {               │                 │                 │
  │                │   acctNumber,    │                 │                 │
  │                │   amount,        │                 │                 │
  │                │   deviceInfo,    │                 │                 │
  │                │   browserInfo,   │                 │                 │
  │                │   billingAddr,   │                 │                 │
  │                │   merchantRiskInd│                 │                 │
  │                │  }               │                 │                 │
  │                │─────────────────>│                 │                 │
  │                │                  │  3. AReq        │                 │
  │                │                  │─────────────────>                 │
  │                │                  │                 │  4. Route to    │
  │                │                  │                 │     ACS         │
  │                │                  │                 │────────────────>│
  │                │                  │                 │                 │
  │                │                  │                 │  5. Risk-Based  │
  │                │                  │                 │     Decision:   │
  │                │                  │                 │                 │
  │      ┌─────────────────────── FRICTIONLESS FLOW ──────────────┐     │
  │      │ Низький ризик: issuer автоматично схвалює               │     │
  │      │ (відомий пристрій, типова сума, довірений торговець)    │     │
  │      │ ACS → ARes: transStatus = "Y" (authenticated)          │     │
  │      └────────────────────────────────────────────────────────┘     │
  │                │                  │                 │                 │
  │      ┌─────────────────────── CHALLENGE FLOW ─────────────────┐     │
  │      │ Високий ризик: потрібна додаткова перевірка             │     │
  │      │ ACS → ARes: transStatus = "C" (challenge required)     │     │
  │      │                                                         │     │
  │  6. Challenge UI (iframe/redirect)                             │     │
  │<═══════════════════════════════════════════════════════════════>│     │
  │      │ Методи challenge:                                       │     │
  │      │  - OTP через SMS/email                                  │     │
  │      │  - Push у банківський додаток                            │     │
  │      │  - Біометрія (fingerprint/face)                         │     │
  │      │  - Out-of-band authentication                           │     │
  │      └────────────────────────────────────────────────────────┘     │
  │                │                  │                 │                 │
  │                │  7. Auth Result  │                 │                 │
  │                │<─────────────────│                 │                 │
  │                │  {authenticationValue: "kBMF...",  │                 │
  │                │   transStatus: "Y",                │                 │
  │                │   eci: "05"}                       │                 │
  │                │                  │                 │                 │
  │                │  8. Authorization Request (з CAVV) │                 │
  │                │  ──────────────────── Acquirer ──── Card Network ──>│
  │                │                  │                 │                 │
  │  9. Payment    │                  │                 │                 │
  │     result     │                  │                 │                 │
  │<───────────────│                  │                 │                 │

ECI (Electronic Commerce Indicator):
  05 — Повна 3DS автентифікація (liability shift на issuer)
  06 — Attempted authentication (issuer/card не підтримує)
  07 — Без 3DS (liability залишається на торговці)</code></pre>

        <p><strong>Огляд управління ключами P2PE:</strong></p>
<pre><code>P2PE Key Management Architecture
==================================

┌─────────────────────────────────────────────────────────┐
│                   Key Hierarchy                         │
│                                                         │
│   Master Key (HSM at Processor)                         │
│       │                                                 │
│       ├── Terminal Master Key (TMK)                     │
│       │       │                                         │
│       │       ├── Session Key (SK) — per transaction    │
│       │       │    ← derived via DUKPT                  │
│       │       │                                         │
│       │       └── PIN Encryption Key (PEK)              │
│       │            ← для шифрування PIN block           │
│       │                                                 │
│       └── Key Encryption Key (KEK)                      │
│            ← для безпечної передачі нових ключів        │
└─────────────────────────────────────────────────────────┘

DUKPT (Derived Unique Key Per Transaction):
─────────────────────────────────────────────
1. При ін'єкції ключів: Base Derivation Key (BDK) → Initial Key (IK)
   BDK зберігається ТІЛЬКИ в HSM процесора
   IK завантажується у Secure Element термінала

2. Для кожної транзакції:
   IK + Key Serial Number (KSN) → Unique Session Key
   KSN = BDK ID (10 hex) + Device ID (5 hex) + Counter (5 hex)

3. Шифрування даних картки:
   Encrypted_Track = AES-256(Session_Key, Card_Data)

4. Процесор:
   KSN → BDK → Session Key → Decrypt(Card_Data)

Безпека:
 - Кожна транзакція = унікальний ключ
 - Компрометація одного ключа не розкриває інші
 - ~1 мільйон можливих ключів на один IK
 - Tamper-resistant terminal: при спробі розкрити — ключі знищуються</code></pre>

        <div class="control-questions">
          <h3>Контрольні запитання</h3>
          <ol>
            <li>Як EMV-чіп забезпечує захист від клонування карток порівняно з магнітною стрічкою? Яку роль відіграє криптограм ARQC?</li>
            <li>Поясніть процес токенізації платежів. Чому витік бази даних токенів торговця не дозволяє зловмиснику здійснити шахрайські операції?</li>
            <li>У чому різниця між frictionless flow та challenge flow у протоколі 3D Secure 2.0? Які фактори впливають на рішення issuer банку?</li>
            <li>Що таке DUKPT і чому він є ключовим елементом безпеки P2PE? Як забезпечується унікальність ключа для кожної транзакції?</li>
            <li>Поясніть концепцію liability shift у контексті EMV та 3D Secure. Як вона стимулює впровадження безпечних технологій?</li>
          </ol>
        </div>
      </section>

      <!-- Section 7.3 -->
      <section>
        <h2>7.3 Мобільні та електронні платежі</h2>

        <p>Мобільні платежі є найбільш швидкозростаючим сегментом платіжної індустрії. В Україні понад 70% банківських операцій здійснюються через мобільні додатки. Безпека мобільних платежів вимагає захисту на рівні пристрою, додатку, мережі та серверу.</p>

        <p><strong>Apple Pay / Google Pay — NFC-платежі:</strong></p>
        <ul>
          <li><strong>Secure Element (SE)</strong> — ізольований чіп на пристрої, де зберігається Device Account Number (DAN) — токенізований номер картки. Навіть при компрометації ОС зловмисник не отримає DAN.</li>
          <li><strong>Dynamic Security Code</strong> — для кожної транзакції генерується одноразовий криптограм, аналогічно EMV-чіпу.</li>
          <li><strong>Біометрична автентифікація</strong> — Face ID/Touch ID перед кожним платежем. Apple Pay не передає біометричні дані серверу — перевірка відбувається локально.</li>
          <li><strong>Privacy</strong> — Apple/Google не знають деталей транзакцій. Торговець отримує лише DAN та криптограм, не реальний PAN.</li>
        </ul>

        <p><strong>QR-платежі</strong> — поширені в Азії (WeChat Pay, Alipay) та набирають популярність в Україні:</p>
        <ul>
          <li><strong>Merchant-Presented QR</strong> — торговець показує QR-код, клієнт сканує та підтверджує оплату. Ризик: підміна QR-коду зловмисником (наклейка поверх оригінального QR).</li>
          <li><strong>Customer-Presented QR</strong> — клієнт показує динамічний QR-код з одноразовим токеном, торговець сканує. Безпечніший варіант.</li>
          <li>Захист: підписані QR з цифровим сертифікатом, короткий TTL для динамічних QR, перевірка merchant identity перед підтвердженням.</li>
        </ul>

        <p><strong>Open Banking та PSD2:</strong></p>
        <ul>
          <li>Payment Services Directive 2 (PSD2) в ЄС зобов'язує банки надавати доступ до рахунків клієнтів через API третім сторонам (за згодою клієнта).</li>
          <li><strong>AISP (Account Information Service Provider)</strong> — доступ до інформації про рахунки (наприклад, для агрегаторів фінансів).</li>
          <li><strong>PISP (Payment Initiation Service Provider)</strong> — ініціювання платежу з рахунку клієнта (наприклад, оплата з банківського рахунку замість картки).</li>
          <li><strong>Strong Customer Authentication (SCA)</strong> — обов'язкова двофакторна автентифікація для онлайн-платежів та доступу до рахунків.</li>
          <li>В Україні НБУ розвиває аналог Open Banking через SEP (Систему електронних платежів) та API-стандарти для банків.</li>
        </ul>

        <p><strong>Потік NFC-платежу Apple Pay:</strong></p>
<pre><code>Apple Pay NFC Payment Flow
===========================

┌──────────────┐                    ┌──────────────┐
│   iPhone     │                    │ POS Terminal │
│              │                    │              │
│ ┌──────────┐ │                    │              │
│ │  Wallet  │ │  1. Наближення    │              │
│ │   App    │ │     до термінала  │              │
│ └────┬─────┘ │  ──────────────>  │              │
│      │       │                    │              │
│  2. Face ID/ │                    │              │
│     Touch ID │                    │              │
│  (локальна   │                    │              │
│  перевірка)  │                    │              │
│      │       │                    │              │
│ ┌────▼─────┐ │                    │              │
│ │  Secure  │ │  3. NFC (13.56 MHz)              │
│ │ Element  │ │  ═══════════════> │              │
│ │          │ │  Дані:            │              │
│ │ DAN:     │ │   - DAN (token)   │              │
│ │ 4761..   │ │   - Dynamic       │              │
│ │          │ │     Security Code │              │
│ │ Payment  │ │   - Device Auth   │              │
│ │ Applet   │ │     Data          │              │
│ └──────────┘ │                    │              │
└──────────────┘                    └──────┬───────┘
                                           │
                                    4. Standard EMV
                                       authorization flow
                                           │
                                    ┌──────▼───────┐
                                    │   Acquirer    │
                                    └──────┬───────┘
                                           │
                                    ┌──────▼───────┐
                                    │ Card Network │ ← De-tokenization:
                                    │ (Visa/MC)    │   DAN → Real PAN
                                    └──────┬───────┘
                                           │
                                    ┌──────▼───────┐
                                    │    Issuer     │ ← Verify cryptogram
                                    │    Bank       │   Check balance
                                    └──────────────┘

Що зберігається в Secure Element:
 ┌──────────────────────────────────────────────────┐
 │ Device Account Number (DAN): 4761 34XX XXXX 9876 │
 │ DAN Expiry:                  12/27              │
 │ Payment Applet:              Visa / MC          │
 │ Cryptographic Keys:          AES-256            │
 │ Application Transaction Counter (ATC)           │
 └──────────────────────────────────────────────────┘

 НЕ зберігається: реальний PAN, CVV, PIN, ім'я власника</code></pre>

        <p><strong>Вимоги PSD2 Strong Customer Authentication (SCA):</strong></p>
<pre><code>PSD2 SCA — Вимоги та виключення
================================

Два з трьох факторів автентифікації (обов'язково):
┌────────────────────┬────────────────────┬────────────────────┐
│  Знання            │  Володіння         │  Властивість       │
│  (Something you    │  (Something you    │  (Something you    │
│   know)            │   have)            │   are)             │
├────────────────────┼────────────────────┼────────────────────┤
│ • Пароль           │ • Мобільний        │ • Відбиток пальця  │
│ • PIN-код          │   телефон          │ • Розпізнавання    │
│ • Кодове слово     │ • Апаратний токен  │   обличчя          │
│ • Графічний ключ   │ • Smart-картка     │ • Голос             │
│                    │ • OTP-генератор    │ • Сканування       │
│                    │                    │   райдужки ока     │
└────────────────────┴────────────────────┴────────────────────┘

Dynamic Linking: автентифікаційний код прив'язується до суми
та отримувача (user бачить «Підтвердіть 500 UAH для ТОВ АБВ»)

Виключення з SCA (не потребують двофакторної):
┌──────────────────────────────────┬─────────────────────────┐
│ Виключення                      │ Умова                   │
├──────────────────────────────────┼─────────────────────────┤
│ Низька сума                     │ &lt; €30 (до 5 поспіль    │
│                                  │ або сума &lt; €100)       │
├──────────────────────────────────┼─────────────────────────┤
│ Довірені бенефіціари             │ Клієнт додав у whitelist│
├──────────────────────────────────┼─────────────────────────┤
│ Рекурентні платежі              │ Та сама сума, той самий │
│                                  │ отримувач (після 1-го)  │
├──────────────────────────────────┼─────────────────────────┤
│ Transaction Risk Analysis (TRA) │ Fraud rate PSP нижче:   │
│                                  │ &lt; €100: fraud &lt; 0.13%  │
│                                  │ &lt; €250: fraud &lt; 0.06%  │
│                                  │ &lt; €500: fraud &lt; 0.01%  │
├──────────────────────────────────┼─────────────────────────┤
│ Корпоративні платежі            │ Dedicated payment       │
│                                  │ process/protocol        │
├──────────────────────────────────┼─────────────────────────┤
│ Merchant-Initiated Transactions │ Підписки, recurring     │
│ (MIT)                            │ після початкової SCA    │
└──────────────────────────────────┴─────────────────────────┘</code></pre>

        <p><strong>Приклад Open Banking API запиту (PSD2-compliant):</strong></p>
<pre><code>// ═══════════════════════════════════════════════════════
// Open Banking API — Payment Initiation (PISP)
// Berlin Group NextGenPSD2 standard
// ═══════════════════════════════════════════════════════

// Крок 1: Запит на ініціювання платежу
// POST /v1/payments/sepa-credit-transfers
// Headers:
//   Authorization: Bearer &lt;OAuth2 access_token&gt;
//   X-Request-ID: 99391c7e-ad88-49ec-a2ad-99ddcb1f7721
//   PSU-IP-Address: 192.168.1.100
//   TPP-Redirect-URI: https://finapp.example.ua/callback

{
  "instructedAmount": {
    "currency": "UAH",
    "amount": "1500.00"
  },
  "debtorAccount": {
    "iban": "UA213223130000026007233566001"
  },
  "creditorName": "ТОВ Інтернет-Магазин",
  "creditorAccount": {
    "iban": "UA713223130000026007233599002"
  },
  "remittanceInformationUnstructured": "Замовлення #12345"
}

// Крок 2: Відповідь банку — потрібна SCA
// HTTP/1.1 201 Created
{
  "transactionStatus": "RCVD",
  "paymentId": "1234-wertiq-983",
  "_links": {
    "scaRedirect": {
      "href": "https://bank.example.ua/auth/sca?paymentId=1234-wertiq-983"
    },
    "self": {
      "href": "/v1/payments/sepa-credit-transfers/1234-wertiq-983"
    },
    "status": {
      "href": "/v1/payments/sepa-credit-transfers/1234-wertiq-983/status"
    }
  }
}

// Крок 3: Після SCA — перевірка статусу
// GET /v1/payments/sepa-credit-transfers/1234-wertiq-983/status
// Response:
{
  "transactionStatus": "ACCP",
  "fundsAvailable": true
}

// Статуси транзакції:
// RCVD — Received (отримано)
// ACTC — AcceptedTechnicalValidation (валідація пройдена)
// ACCP — AcceptedCustomerProfile (SCA пройдена, кошти доступні)
// ACSC — AcceptedSettlementCompleted (платіж виконано)
// RJCT — Rejected (відхилено)</code></pre>

        <div class="control-questions">
          <h3>Контрольні запитання</h3>
          <ol>
            <li>Як Secure Element у смартфоні забезпечує безпеку NFC-платежів Apple Pay/Google Pay? Чому компрометація операційної системи не розкриває платіжні дані?</li>
            <li>Які два з трьох факторів автентифікації вимагає PSD2 SCA та у яких випадках допускаються виключення?</li>
            <li>Порівняйте безпеку Merchant-Presented QR та Customer-Presented QR кодів. Який підхід є безпечнішим і чому?</li>
            <li>Яка різниця між AISP та PISP у контексті Open Banking? Які ризики пов'язані з наданням доступу третім сторонам до банківських рахунків?</li>
            <li>Поясніть концепцію Dynamic Linking у PSD2. Чому автентифікаційний код має бути прив'язаний до суми та отримувача платежу?</li>
          </ol>
        </div>
      </section>

      <!-- Section 7.4 -->
      <section>
        <h2>7.4 Fraud detection та моніторинг транзакцій</h2>

        <p>Fraud detection — це система виявлення шахрайських транзакцій у реальному часі. За даними Nilson Report, глобальні втрати від карткового шахрайства перевищують $30 мільярдів на рік. Сучасні системи fraud detection повинні аналізувати мільйони транзакцій на секунду з мінімальною затримкою (менше 100 мс на рішення).</p>

        <p><strong>Rule-based системи</strong> — перше покоління fraud detection:</p>
        <ul>
          <li>Статичні правила: «Заблокувати транзакцію понад $10,000 з нової країни», «Позначити 3+ транзакції за 5 хвилин з різних міст».</li>
          <li>Переваги: прозорість (зрозуміло, чому заблоковано), простота реалізації, відповідність compliance-вимогам.</li>
          <li>Недоліки: не адаптуються до нових патернів fraud, високий false positive rate (легітимні транзакції блокуються), легко обходяться досвідченими шахраями, які знають правила.</li>
        </ul>

        <p><strong>ML-based системи</strong> — сучасний підхід до fraud detection:</p>
        <ul>
          <li><strong>Supervised learning</strong> — моделі (Random Forest, XGBoost, Neural Networks) навчені на історичних даних fraud/non-fraud. Переваги: високий detection rate, низький false positive, адаптація до нових патернів.</li>
          <li><strong>Unsupervised learning</strong> — виявлення аномалій без розмічених даних. Автоенкодери, isolation forest визначають транзакції, що відхиляються від нормальної поведінки клієнта.</li>
          <li><strong>Real-time scoring</strong> — кожна транзакція отримує fraud score (0-1000) на основі: суми, локації, часу, merchant category, device fingerprint, історії клієнта, швидкості транзакцій.</li>
          <li><strong>Graph analytics</strong> — виявлення мереж шахрайства: пов'язані акаунти, спільні пристрої, money mule ланцюжки.</li>
        </ul>

        <p><strong>Поведінковий аналіз (Behavioral Analytics):</strong></p>
        <ul>
          <li>Створення профілю «нормальної» поведінки для кожного клієнта: типові суми, merchant categories, час транзакцій, геолокація, пристрої.</li>
          <li>Відхилення від профілю збільшує risk score: клієнт зазвичай платить 200-500 грн в супермаркетах у Києві, раптом — переказ 50,000 грн з нового пристрою о 3:00 AM з IP Нігерії.</li>
          <li>Adaptive authentication: залежно від risk score система вимагає різний рівень автентифікації (step-up auth) — низький ризик: без додаткових запитів; середній: push-підтвердження; високий: повна повторна автентифікація або блокування.</li>
        </ul>

        <p><strong>Chargeback та dispute management.</strong> Коли клієнт оскаржує транзакцію, банк-емітент ініціює chargeback — повернення коштів. Для торговця це означає: повернення суми транзакції + комісія за chargeback ($20-100) + ризик потрапити в chargeback monitoring program (при >1% chargeback rate). Ефективний fraud detection зменшує chargeback rate та захищає як клієнтів, так і торговців.</p>

        <p><strong>Приклад rule-based fraud detection (псевдокод):</strong></p>
<pre><code>// ═══════════════════════════════════════════════════════════
// Fraud Detection Engine — Rule-Based System (псевдокод)
// ═══════════════════════════════════════════════════════════

FUNCTION evaluate_transaction(txn, customer_profile):
    risk_score = 0
    alerts = []

    // Правило 1: Велика сума для нового клієнта
    IF txn.amount > 10000 AND customer_profile.account_age_days < 30:
        risk_score += 300
        alerts.append("HIGH_AMOUNT_NEW_ACCOUNT")

    // Правило 2: Географічна аномалія
    IF txn.country != customer_profile.home_country:
        time_since_last_domestic = now() - customer_profile.last_domestic_txn
        IF time_since_last_domestic < hours(2):
            // Неможливо фізично переміститись за такий час
            risk_score += 400
            alerts.append("IMPOSSIBLE_TRAVEL")

    // Правило 3: Velocity check — занадто багато транзакцій
    recent_txns = get_transactions(customer_profile.id, last_minutes=10)
    IF count(recent_txns) > 5:
        risk_score += 250
        alerts.append("VELOCITY_EXCEEDED")

    // Правило 4: Підозрілий MCC (Merchant Category Code)
    high_risk_mcc = [6051, 7995, 6211]  // Crypto, gambling, securities
    IF txn.mcc IN high_risk_mcc AND txn.amount > 5000:
        risk_score += 200
        alerts.append("HIGH_RISK_MCC")

    // Правило 5: Нічний час + великий переказ
    IF txn.local_time.hour BETWEEN 1 AND 5:
        IF txn.type == "P2P_TRANSFER" AND txn.amount > 20000:
            risk_score += 350
            alerts.append("NIGHT_LARGE_TRANSFER")

    // Правило 6: Перший платіж на новому пристрої
    IF txn.device_id NOT IN customer_profile.known_devices:
        risk_score += 150
        alerts.append("NEW_DEVICE")
        IF txn.amount > customer_profile.avg_amount * 3:
            risk_score += 200
            alerts.append("NEW_DEVICE_HIGH_AMOUNT")

    // Рішення на основі сумарного risk score
    SWITCH risk_score:
        CASE 0..299:    RETURN {action: "APPROVE", score: risk_score}
        CASE 300..599:  RETURN {action: "STEP_UP_AUTH", score: risk_score,
                                method: "PUSH_NOTIFICATION"}
        CASE 600..799:  RETURN {action: "REVIEW", score: risk_score,
                                alerts: alerts, queue: "L1_ANALYST"}
        CASE 800+:     RETURN {action: "DECLINE", score: risk_score,
                                alerts: alerts, reason: "HIGH_FRAUD_RISK"}
</code></pre>

        <p><strong>Таблиця фіч ML-моделі для скорингу транзакцій:</strong></p>
<pre><code>ML Feature Engineering — Transaction Scoring Model
====================================================

┌─────┬──────────────────────────┬─────────┬─────────────────────────────────┐
│  #  │ Feature (ознака)         │ Тип     │ Опис / приклад                  │
├─────┼──────────────────────────┼─────────┼─────────────────────────────────┤
│  1  │ txn_amount               │ float   │ Сума транзакції (UAH)           │
│  2  │ txn_amount_zscore        │ float   │ Відхилення від середньої суми   │
│     │                          │         │ клієнта (z-score)               │
│  3  │ txn_hour                 │ int     │ Година доби (0-23)              │
│  4  │ txn_day_of_week          │ int     │ День тижня (0-6)               │
│  5  │ merchant_category_code   │ cat     │ MCC код торговця                │
│  6  │ merchant_risk_level      │ cat     │ low / medium / high / very_high │
│  7  │ is_domestic              │ bool    │ Внутрішня/міжнародна транзакція │
│  8  │ country_risk_score       │ float   │ Рівень ризику країни (0-1)      │
│  9  │ distance_from_home       │ float   │ Відстань від домашньої локації  │
│ 10  │ velocity_1h              │ int     │ К-ть транзакцій за останню год. │
│ 11  │ velocity_24h             │ int     │ К-ть транзакцій за 24 години    │
│ 12  │ total_amount_24h         │ float   │ Загальна сума за 24 години      │
│ 13  │ time_since_last_txn      │ float   │ Час від попередньої транзакції  │
│ 14  │ is_new_merchant          │ bool    │ Перший платіж у цього торговця  │
│ 15  │ is_new_device            │ bool    │ Транзакція з нового пристрою    │
│ 16  │ device_age_days          │ int     │ Вік пристрою в системі (дні)   │
│ 17  │ device_fingerprint_match │ float   │ Збіг з відомим fingerprint (0-1)│
│ 18  │ ip_proxy_score           │ float   │ Ймовірність VPN/proxy (0-1)    │
│ 19  │ email_domain_age         │ int     │ Вік домену email (дні)         │
│ 20  │ account_age_days         │ int     │ Вік акаунту клієнта (дні)      │
│ 21  │ avg_txn_amount_30d       │ float   │ Середня сума за 30 днів        │
│ 22  │ std_txn_amount_30d       │ float   │ Стандартне відхилення за 30 дн. │
│ 23  │ has_3ds                  │ bool    │ 3D Secure автентифікація        │
│ 24  │ card_present             │ bool    │ Card-present / card-not-present │
│ 25  │ failed_auth_24h          │ int     │ Невдалі спроби автентифікації   │
└─────┴──────────────────────────┴─────────┴─────────────────────────────────┘

Модель: XGBoost Classifier
 - Training set:  10M транзакцій (fraud rate ~0.1%)
 - SMOTE oversampling для балансування класів
 - Метрики: Precision 94.2%, Recall 87.5%, F1 90.7%, AUC-ROC 0.993
 - Latency: p50 = 12ms, p99 = 45ms</code></pre>

        <p><strong>Приклад Real-Time Scoring API:</strong></p>
<pre><code>// ═══════════════════════════════════════════════════════
// Real-Time Fraud Scoring API
// POST /api/v2/fraud/score
// Latency SLA: &lt; 100ms (p99)
// ═══════════════════════════════════════════════════════

// Request:
{
  "transaction_id": "txn_7f3a8b2c1d4e",
  "timestamp": "2024-11-15T14:32:08Z",
  "card_token": "tok_4761XXXXXXXX9876",
  "amount": 28500.00,
  "currency": "UAH",
  "merchant": {
    "id": "merch_electronics_001",
    "name": "ТОВ Електроніка Плюс",
    "mcc": "5732",
    "country": "UA",
    "city": "Київ"
  },
  "channel": "e-commerce",
  "device": {
    "fingerprint": "fp_a8b3c2d1e4f5",
    "ip_address": "91.196.XX.XX",
    "user_agent": "Mozilla/5.0..."
  },
  "authentication": {
    "method": "3DS2",
    "status": "challenge_completed"
  }
}

// Response (12ms):
{
  "transaction_id": "txn_7f3a8b2c1d4e",
  "fraud_score": 742,
  "risk_level": "HIGH",
  "recommendation": "REVIEW",
  "model_version": "xgb_v3.2.1",
  "scoring_time_ms": 11,
  "risk_factors": [
    {
      "factor": "AMOUNT_ANOMALY",
      "weight": 0.35,
      "detail": "Сума у 8.5x перевищує середню для клієнта"
    },
    {
      "factor": "NEW_MERCHANT_CATEGORY",
      "weight": 0.20,
      "detail": "Клієнт ніколи не купував в MCC 5732"
    },
    {
      "factor": "VELOCITY_SPIKE",
      "weight": 0.25,
      "detail": "4-та транзакція за останні 30 хвилин"
    },
    {
      "factor": "DEVICE_MISMATCH",
      "weight": 0.20,
      "detail": "Новий device fingerprint, не в known_devices"
    }
  ],
  "suggested_action": {
    "type": "STEP_UP_AUTH",
    "method": "PUSH_NOTIFICATION",
    "message": "Підтвердіть оплату 28 500 ₴ в ТОВ Електроніка Плюс"
  }
}</code></pre>

        <p><strong>Потік процесу Chargeback:</strong></p>
<pre><code>Chargeback Process Flow
========================

Час     Крок                          Учасники
─────   ─────────────────────────     ──────────────────────
Day 0   Транзакція здійснена           Клієнт → Торговець
        Amount: 15,000 UAH
        Auth Code: 847291
        │
Day 45  Клієнт оскаржує транзакцію    Клієнт → Issuer банк
        Причина: "Я не здійснював     (Reason Code: 10.4 —
        цю покупку"                    Fraud / Card-Absent)
        │
Day 46  Issuer ініціює chargeback      Issuer → Card Network
        Provisional credit клієнту:    → Acquirer
        +15,000 UAH на рахунок
        │
Day 47  Acquirer повідомляє торговця   Acquirer → Торговець
        Списання: -15,000 UAH         Chargeback fee: -750 UAH
        від суми розрахунків
        │
        Торговець має 30 днів на
        representment (оскарження)
        │
        ┌── Варіант A: Торговець       Торговець → Acquirer
        │   подає Representment        → Card Network → Issuer
        │   Докази:
        │   - AVS match
        │   - 3DS authentication
        │   - Delivery confirmation
        │   - IP/device logs
        │   - Customer correspondence
        │
        │   Issuer переглядає →
        │   ├── Прийнято: Chargeback reversed
        │   │   Торговцю повернено 15,000 UAH
        │   │
        │   └── Відхилено: Pre-Arbitration
        │       → Arbitration (Card Network вирішує)
        │       → Програвша сторона сплачує ~$500 fee
        │
        └── Варіант B: Торговець
            приймає chargeback
            Втрата: 15,000 + 750 = 15,750 UAH

Chargeback Monitoring Programs:
┌────────────────┬─────────────────────┬──────────────────────────┐
│ Card Network   │ Програма            │ Порогові значення        │
├────────────────┼─────────────────────┼──────────────────────────┤
│ Visa           │ VDMP (Dispute       │ > 100 disputes/month     │
│                │ Monitoring Program) │ AND > 0.9% dispute ratio │
├────────────────┼─────────────────────┼──────────────────────────┤
│ Visa           │ VFMP (Fraud         │ > $75K fraud/month       │
│                │ Monitoring Program) │ AND > 0.9% fraud ratio   │
├────────────────┼─────────────────────┼──────────────────────────┤
│ Mastercard     │ EFM (Excessive      │ > 100 chargebacks/month  │
│                │ Fraud Merchant)     │ AND > 0.50% CB ratio     │
│                │                     │ AND > $50K fraud amount  │
├────────────────┼─────────────────────┼──────────────────────────┤
│ Mastercard     │ ECM (Excessive      │ > 100 chargebacks/month  │
│                │ Chargeback Merchant)│ AND > 1.5% CB ratio      │
└────────────────┴─────────────────────┴──────────────────────────┘

Наслідки потрапляння у monitoring program:
 - Місячні штрафи від $10,000 до $100,000
 - Обов'язковий план корективних дій
 - Можливе припинення права приймати картки</code></pre>

        <div class="control-questions">
          <h3>Контрольні запитання</h3>
          <ol>
            <li>Порівняйте rule-based та ML-based підходи до fraud detection. У яких випадках кожен з підходів є більш ефективним?</li>
            <li>Які ознаки (features) використовуються ML-моделями для скорингу транзакцій? Поясніть, чому velocity-фічі та device fingerprint є важливими.</li>
            <li>Що таке поведінковий аналіз (behavioral analytics) у контексті fraud detection та як він пов'язаний з adaptive authentication?</li>
            <li>Опишіть процес chargeback від моменту оскарження клієнтом до фінального рішення. Які наслідки для торговця при високому chargeback rate?</li>
            <li>Як працює real-time scoring API і чому критично важливо забезпечити час відповіді менше 100 мс? Які архітектурні рішення це забезпечують?</li>
          </ol>
        </div>
      </section>

      <!-- Summary -->
      <section>
        <h2>Підсумок</h2>
        <p>У цій лекції ми розглянули безпеку платіжних систем — від стандарту PCI DSS з його 12 вимогами до сучасних технологій захисту транзакцій. EMV-чіпи, токенізація та 3D Secure 2.0 забезпечують багаторівневий захист карткових платежів, а Apple Pay/Google Pay демонструють, як Secure Element та біометрія роблять мобільні платежі навіть безпечнішими за карткові.</p>
        <p>Open Banking (PSD2) відкриває нові можливості, але вимагає Strong Customer Authentication та захисту API. ML-based fraud detection системи аналізують мільйони транзакцій у реальному часі, виявляючи шахрайство за мілісекунди на основі поведінкових патернів та graph analytics.</p>
        <p><strong>У наступній лекції</strong> ми розглянемо соціальну інженерію та психологію шахрайства: фішинг, вішинг, pretexting та психологічні прийоми, які використовують зловмисники для маніпулювання людьми у фінансовому секторі.</p>
      </section>
    </article>

    <div class="lecture-nav-bottom">
      <a href="../../lecture.html?id=7" class="nav-btn">&larr; Назад до лекції</a>
      <span></span>
    </div>

    <footer></footer>
  </main>

  <script src="../../js/main.js"></script>

</body>
</html>
